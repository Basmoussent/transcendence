export const translations = {
  fr: {
    home: {
      title: "Pong",
      subtitle: "Découvrez Pong",
      description: "Une expérience de jeu classique revisitée",
      login: "Connexion"
    },
    auth: {
      login: {
        title: "Connexion",
        username: "Nom d'utilisateur",
        password: "Mot de passe",
        submit: "Se connecter",
        forgotPassword: "Mot de passe oublié ?",
        createAccount: "Créer un compte"
      },
      createAccount: {
        title: "Créer un compte",
        username: "Nom d'utilisateur",
        email: "Email",
        password: "Mot de passe",
        confirmPassword: "Confirmer le mot de passe",
        submit: "Créer un compte",
        backToLogin: "Retour à la connexion"
      },
      forgotPassword: {
        title: "Mot de passe oublié",
        description: "Entrez votre email pour recevoir un lien de réinitialisation",
        email: "Email",
        submit: "Envoyer le lien",
        backToLogin: "Retour à la connexion"
      },
      changePassword: {
        title: "Changer le mot de passe",
        currentPassword: "Mot de passe actuel",
        newPassword: "Nouveau mot de passe",
        confirmNewPassword: "Confirmer le nouveau mot de passe",
        submit: "Modifier le mot de passe",
        backToProfile: "Retour au profil"
      }
    },
    menu: {
      title: "Transcendence",
      profile: "Profil",
      playLocal: "Jouer en local",
      multiplayer: "Multijoueur",
      friends: "Amis"
    },
    profile: {
      title: "Profil",
      editProfile: "Modifier le profil",
      changePassword: "Changer le mot de passe",
      logout: "Déconnexion",
      stats: {
        wins: "Victoires",
        games: "Parties",
        rating: "Classement"
      },
      recentActivity: "Activité récente",
      wonAgainst: "Victoire contre",
      addedFriend: "Ajouté un ami",
      hoursAgo: "heures",
      daysAgo: "jours",
      edit: {
        title: "Modifier le profil",
        username: "Nom d'utilisateur",
        email: "Pseudo",
        avatar: "Avatar",
        submit: "Enregistrer",
        backToProfile: "Annuler"
      }
    },
    social: {
      title: "Social",
      searchPlaceholder: "Rechercher des amis...",
      friends: {
        title: "Amis",
        addFriend: "Ajouter un ami",
        online: "En ligne",
        offline: "Hors ligne",
        message: "Message",
        play: "Jouer"
      },
      friendRequests: {
        title: "Demandes d'amis",
        accept: "Accepter",
        decline: "Refuser"
      },
      chat: {
        title: "Chat",
        newChat: "Nouvelle conversation",
        ago: "il y a"
      }
    },
    friends: {
      backToSocial: "Retour",
      online: "En ligne",
      offline: "Hors ligne",
      lastSeen: "Vu",
      stats: {
        wins: "Victoires",
        games: "Parties",
        rating: "Classement"
      },
      sendMessage: "Envoyer un message",
      inviteToGame: "Inviter à jouer",
      removeFriend: "Retirer des amis"
    }
  },
  en: {
    home: {
      title: "Pong",
      subtitle: "Discover Pong",
      description: "A classic gaming experience reimagined",
      login: "Login"
    },
    auth: {
      login: {
        title: "Login",
        username: "Username",
        password: "Password",
        submit: "Sign in",
        forgotPassword: "Forgot password?",
        createAccount: "Create account"
      },
      createAccount: {
        title: "Create Account",
        username: "Username",
        email: "Email",
        password: "Password",
        confirmPassword: "Confirm password",
        submit: "Create account",
        backToLogin: "Back to login"
      },
      forgotPassword: {
        title: "Forgot Password",
        description: "Enter your email to receive a reset link",
        email: "Email",
        submit: "Send link",
        backToLogin: "Back to login"
      },
      changePassword: {
        title: "Change Password",
        currentPassword: "Current Password",
        newPassword: "New Password",
        confirmNewPassword: "Confirm New Password",
        submit: "Change Password",
        backToProfile: "Back to Profile"
      }
    },
    menu: {
      title: "Transcendence",
      profile: "Profile",
      playLocal: "Play Local",
      multiplayer: "Multiplayer",
      friends: "Friends"
    },
    profile: {
      title: "Profile",
      editProfile: "Edit Profile",
      changePassword: "Change Password",
      logout: "Logout",
      stats: {
        wins: "Wins",
        games: "Games",
        rating: "Rating"
      },
      recentActivity: "Recent Activity",
      wonAgainst: "Won against",
      addedFriend: "Added friend",
      hoursAgo: "hours ago",
      daysAgo: "days ago",
      edit: {
        title: "Edit Profile",
        username: "Username",
        email: "Username",
        avatar: "Avatar",
        submit: "Save",
        backToProfile: "Cancel"
      }
    },
    social: {
      title: "Social",
      searchPlaceholder: "Search friends...",
      friends: {
        title: "Friends",
        addFriend: "Add Friend",
        online: "Online",
        offline: "Offline",
        message: "Message",
        play: "Play"
      },
      friendRequests: {
        title: "Friend Requests",
        accept: "Accept",
        decline: "Decline"
      },
      chat: {
        title: "Chat",
        newChat: "New Chat",
        ago: "ago"
      }
    },
    friends: {
      backToSocial: "Back",
      online: "Online",
      offline: "Offline",
      lastSeen: "Last seen",
      stats: {
        wins: "Wins",
        games: "Games",
        rating: "Rating"
      },
      sendMessage: "Send Message",
      inviteToGame: "Invite to Game",
      removeFriend: "Remove Friend"
    }
  },
  es: {
    home: {
      title: "Pong",
      subtitle: "Descubre Pong",
      description: "Una experiencia de juego clásica reinventada",
      login: "Iniciar sesión"
    },
    auth: {
      login: {
        title: "Iniciar sesión",
        username: "Nombre de usuario",
        password: "Contraseña",
        submit: "Iniciar sesión",
        forgotPassword: "¿Olvidaste tu contraseña?",
        createAccount: "Crear cuenta"
      },
      createAccount: {
        title: "Crear cuenta",
        username: "Nombre de usuario",
        email: "Correo electrónico",
        password: "Contraseña",
        confirmPassword: "Confirmar contraseña",
        submit: "Crear cuenta",
        backToLogin: "Volver al inicio de sesión"
      },
      forgotPassword: {
        title: "Olvidaste tu contraseña",
        description: "Ingresa tu correo electrónico para recibir un enlace de restablecimiento",
        email: "Correo electrónico",
        submit: "Enviar enlace",
        backToLogin: "Volver al inicio de sesión"
      },
      changePassword: {
        title: "Cambiar contraseña",
        currentPassword: "Contraseña actual",
        newPassword: "Nueva contraseña",
        confirmNewPassword: "Confirmar nueva contraseña",
        submit: "Cambiar contraseña",
        backToProfile: "Volver al perfil"
      }
    },
    menu: {
      title: "Transcendence",
      profile: "Perfil",
      playLocal: "Jugar local",
      multiplayer: "Multijugador",
      friends: "Amigos"
    },
    profile: {
      title: "Perfil",
      editProfile: "Editar perfil",
      changePassword: "Cambiar contraseña",
      logout: "Cerrar sesión",
      stats: {
        wins: "Victorias",
        games: "Partidas",
        rating: "Clasificación"
      },
      recentActivity: "Actividad reciente",
      wonAgainst: "Victoria contra",
      addedFriend: "Añadido amigo",
      hoursAgo: "horas",
      daysAgo: "días",
      edit: {
        title: "Editar perfil",
        username: "Nombre de usuario",
        email: "Usuario",
        avatar: "Avatar",
        submit: "Guardar",
        backToProfile: "Cancelar"
      }
    },
    social: {
      title: "Social",
      searchPlaceholder: "Buscar amigos...",
      friends: {
        title: "Amigos",
        addFriend: "Añadir amigo",
        online: "En línea",
        offline: "Desconectado",
        message: "Mensaje",
        play: "Jugar"
      },
      friendRequests: {
        title: "Solicitudes de amistad",
        accept: "Aceptar",
        decline: "Rechazar"
      },
      chat: {
        title: "Chat",
        newChat: "Nuevo chat",
        ago: "hace"
      }
    },
    friends: {
      backToSocial: "Volver",
      online: "En línea",
      offline: "Desconectado",
      lastSeen: "Visto por última vez",
      stats: {
        wins: "Victorias",
        games: "Partidas",
        rating: "Clasificación"
      },
      sendMessage: "Enviar mensaje",
      inviteToGame: "Invitar a jugar",
      removeFriend: "Eliminar amigo"
    }
  }
} as const;

type Language = keyof typeof translations;
type TranslationKeys = 
  | 'home.title'
  | 'home.subtitle'
  | 'home.description'
  | 'home.login'
  | 'auth.login.title'
  | 'auth.login.username'
  | 'auth.login.password'
  | 'auth.login.submit'
  | 'auth.login.forgotPassword'
  | 'auth.login.createAccount'
  | 'auth.createAccount.title'
  | 'auth.createAccount.username'
  | 'auth.createAccount.email'
  | 'auth.createAccount.password'
  | 'auth.createAccount.confirmPassword'
  | 'auth.createAccount.submit'
  | 'auth.createAccount.backToLogin'
  | 'auth.forgotPassword.title'
  | 'auth.forgotPassword.description'
  | 'auth.forgotPassword.email'
  | 'auth.forgotPassword.submit'
  | 'auth.forgotPassword.backToLogin'
  | 'auth.changePassword.title'
  | 'auth.changePassword.currentPassword'
  | 'auth.changePassword.newPassword'
  | 'auth.changePassword.confirmNewPassword'
  | 'auth.changePassword.submit'
  | 'auth.changePassword.backToProfile'
  | 'menu.title'
  | 'menu.profile'
  | 'menu.playLocal'
  | 'menu.multiplayer'
  | 'menu.friends'
  | 'profile.title'
  | 'profile.editProfile'
  | 'profile.changePassword'
  | 'profile.logout'
  | 'profile.stats.wins'
  | 'profile.stats.games'
  | 'profile.stats.rating'
  | 'profile.recentActivity'
  | 'profile.wonAgainst'
  | 'profile.addedFriend'
  | 'profile.hoursAgo'
  | 'profile.daysAgo'
  | 'profile.edit.title'
  | 'profile.edit.username'
  | 'profile.edit.email'
  | 'profile.edit.avatar'
  | 'profile.edit.submit'
  | 'profile.edit.backToProfile'
  | 'social.title'
  | 'social.searchPlaceholder'
  | 'social.friends.title'
  | 'social.friends.addFriend'
  | 'social.friends.online'
  | 'social.friends.offline'
  | 'social.friends.message'
  | 'social.friends.play'
  | 'social.friendRequests.title'
  | 'social.friendRequests.accept'
  | 'social.friendRequests.decline'
  | 'social.chat.title'
  | 'social.chat.newChat'
  | 'social.chat.ago'
  | 'friends.backToSocial'
  | 'friends.online'
  | 'friends.offline'
  | 'friends.lastSeen'
  | 'friends.stats.wins'
  | 'friends.stats.games'
  | 'friends.stats.rating'
  | 'friends.sendMessage'
  | 'friends.inviteToGame'
  | 'friends.removeFriend';

export function getLanguage(): Language {
  const subdomain = localStorage.getItem('lang');
  const supportedLanguages = ['en', 'fr', 'es'] as const;

  return supportedLanguages.includes(subdomain as Language) ? subdomain as Language : 'en';
}

let translationCache: Map<string, string> = new Map();
let currentLanguage: Language | null = null;

export function clearTranslationCache() {
  translationCache.clear();
  currentLanguage = null;
}

export function t(key: TranslationKeys): string {
  const lang = getLanguage();
  
  // Clear cache if language changed
  if (currentLanguage !== lang) {
    clearTranslationCache();
    currentLanguage = lang;
  }
  
  // Check cache first
  const cacheKey = `${lang}:${key}`;
  if (translationCache.has(cacheKey)) {
    return translationCache.get(cacheKey)!;
  }
  
  const keys = key.split('.');
  let value: any = translations[lang];
  
  for (const k of keys) {
    if (value && typeof value === 'object') {
      value = value[k];
    } else {
      translationCache.set(cacheKey, key);
      return key;
    }
  }
  
  const result = typeof value === 'string' ? value : key;
  translationCache.set(cacheKey, result);
  return result;
} 